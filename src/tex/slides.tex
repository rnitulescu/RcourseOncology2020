%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Slides : R for clinical trialists %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% PREAMBLE
%% Define document class and basic options
\documentclass{beamer}
%\setlength{\parindent}{0pt}

%% Load packages
\usepackage{palatino}
%\usepackage{amsfonts}
%\usepackage{amsmath}
%\usepackage{url}
\usepackage{hyperref}
%\usepackage{listings}
\usepackage{verbatim}

\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	citecolor=red,
	filecolor=blue,
	urlcolor=blue
}

\usetheme{Madrid}

%% Basic info
\title{R for Clinical Trialists}
\subtitle{An Introduction}
\author{Roy Nitulescu\inst{1}}

\institute
{
    \inst{1}%
    CITADEL\\
    CR-CHUM
}

\date[McGill, Nov. 18, 2020]{McGill University, Nov. 18, 2020}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[currentsection]
    \end{frame}
}

\AtBeginSubsection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[currentsubsection]
    \end{frame}
}


%% BEGIN DOCUMENT
\begin{document}

%%%%
%% Slides
%%%%

\frame{\titlepage}

\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents
\end{frame}


%%%%
%% MODULE 1
%%%%

\section{Module 1: Introduction to R}

\subsection{Getting started}

%% Intro
%% Commented out this and the next slide and replaced with one simpler slide
%\begin{frame}
%    \frametitle{What is R?}
%    \begin{enumerate}
%      \item Free/Libre and Open Source Software (FLOSS)
%      \begin{enumerate}
%        \item Free as in ``free beer'', but also free as in ``free speech''
%        \item Users are free to look at the source code, suggest improvements, submit bug fixes, and create custom libraries
%        \item This encourages the development of a community of users working together to improve the software and make it accessible
%      \end{enumerate}
%      \item R is a software environment for statistical computing and graphics
%      \begin{enumerate}
%        \item Process data, calculate summary statistics, and fit statistical models with very litte code
%        \item Create standard plots with very little code or build custom graphics to suit any needs
%        \item Interact with your operating system to automate many tedious tasks
%      \end{enumerate}
%    \end{enumerate}
%\end{frame}


%\begin{frame}
%    \frametitle{Strengths and Weaknesses}
%    \begin{enumerate}
%      \item Strengths
%      \begin{enumerate}
%        \item Accessible, portable, and well documented
%        \item Flexible and extendable
%        \item Relatively efficient (especially compared to SAS)
%      \end{enumerate}
%      \item Weaknesses
%      \begin{enumerate}
%        \item Data must fit in memory (this can be overcome with some libraries)
%        \item Steep learning curve (especially compared to SAS or Stata)
%        \item Efficient extension requires professional programming know-how
%      \end{enumerate}
%    \end{enumerate}
%\end{frame}


%% Simpler version of the above
\begin{frame}
    \frametitle{What is R?}
    \begin{itemize}
	  \item Software environment for statistical computing and graphics
	  \item Steep learning curve
	  \item Worth learning due to its ubiquity, versatility, and efficiency
    \end{itemize}
\end{frame}


\begin{frame}
	\frametitle{Installing R}
	\begin{itemize}
	  \item Web page: \url{http://cran.utstat.utoronto.ca/}\footnote{This is the Ontario mirror. You can choose any mirror from here: \url{https://cran.r-project.org/mirrors.html}}
	  \item \textbf{Windows and Mac}: Download and install precompiled binary distributions
	  \item \textbf{Linux}: Install through package manager or compile from source
	\end{itemize}
\end{frame}


\begin{frame}
    \frametitle{Getting help}
    \begin{itemize}
	  \item Official documentation: \url{https://cran.r-project.org/manuals.html}
	  \item Cheat sheet: \href{https://cran.r-project.org/doc/contrib/Short-refcard.pdf}{Link}
	  \item Forums: \url{https://stackoverflow.com/}, \url{https://stackexchange.com/}, etc.
	  \item In R: \texttt{?topic}, \texttt{??keyword}
	  \item Examples of general topics: \texttt{?Logic}, \texttt{?Arithmetic}, \texttt{?Syntax}
	  \item Examples of more specific topics: \texttt{?getwd}, \texttt{?dir}
    \end{itemize}
\end{frame}


%% Core material
\subsection{Basic R objects}

\begin{frame}[fragile]
    \frametitle{The environment}
    \begin{itemize}
      \item Working directory, paths, files
      \item libraries and the \emph{global} environment
      \item Objects in the \emph{local} environment
      \item \texttt{options()} function (see documentaton for details)
    \end{itemize}
    \verbatiminput{../R/module1/environment.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{Scalars and vectors}
    \verbatiminput{../R/module1/scalars_vectors.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{Matrices}
    \verbatiminput{../R/module1/matrices.Rout}
\end{frame}


\begin{frame}
    \frametitle{Retrieving elements}
    Elements of vectors and matrices can be retrieved either by numeric indexing (1, 2, 3, etc.)
    or by logical indexing (TRUE, FALSE).
    This means that one can index an R object using expressions that resolve to logical vectors.
    In fact, this technique is used a lot in practice.
    Also note that the function \texttt{which} can be used to convert from logical to numeric indexing.
    \begin{itemize}
      \item Vectors
        \begin{itemize}
          \item Retrieve element \texttt{n} of vector \texttt{x}: \texttt{> x[n]}
          \item 3rd element of a vector of length 3:\\ \texttt{> x[c(FALSE, FALSE, TRUE)]}
        \end{itemize}
      \item Matrices (\texttt{r} for row and \texttt{c} for column)
        \begin{itemize}
          \item Retrieve element (\texttt{r}, \texttt{c}) from matrix \texttt{X}: \texttt{> X[r, c]}
          \item Retrieve row \texttt{r} from matrix \texttt{X}: \texttt{> X[r, ]}
          \item Retrieve column \texttt{c} from matrix \texttt{X}: \texttt{> X[, c]}
        \end{itemize}
    \end{itemize}
    \textbf{Question}: What is the difference between \texttt{X[1,2]} and \texttt{X[c(1,2)]}?
\end{frame}


\begin{frame}[fragile]
    \frametitle{Lists}
    \fontsize{11pt}{10}\selectfont
    \verbatiminput{../R/module1/lists.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{Data frames}
    \verbatiminput{../R/module1/dataframes.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{Accessing objects}
	\begin{itemize}
	  \item S3 objects
	    \begin{itemize}
	      \item For vectors and matrices, accessing elements is pretty straightforward (see above)
	      \item For other objects, it can be a little more abstract
	      \item It is easier to understand them through examples (cue mtcars example)
	      \item \texttt{[]}: Access component(s) inside of an object
	      \item \texttt{\$}: Access contents of a single component inside of an object
	      \item \texttt{[[]]}: Same as \texttt{\$}, but more flexible for programming
	    \end{itemize}
	  \item S4 objects are beyond the scope of this course
	\end{itemize}
\end{frame}


\subsection{Control structures}

\begin{frame}[fragile]
    \frametitle{if, else}
    \verbatiminput{../R/module1/if_else.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{for, while}
    \verbatiminput{../R/module1/for_while.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{repeat, next, break}
    \verbatiminput{../R/module1/repeat_next_break.Rout}
\end{frame}


\subsection{Basic object manipulation}

\begin{frame}[fragile]
    \frametitle{c, rbind, cbind}
    \verbatiminput{../R/module1/c_rbind_cbind.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{merge}
    \verbatiminput{../R/module1/merge.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{subset}
    \verbatiminput{../R/module1/subset.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{order, names}
    \verbatiminput{../R/module1/order_names.Rout}
\end{frame}


\subsection{Intermediate object manipulation}

\begin{frame}[fragile]
    \frametitle{aggregate}
    \verbatiminput{../R/module1/aggregate.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{reshape}
    \verbatiminput{../R/module1/reshape.Rout}
\end{frame}


\subsection{Basic variable transformation}

\begin{frame}[fragile]
    \frametitle{Working with dates}
    \verbatiminput{../R/module1/dates.Rout}
\end{frame}


\begin{frame}[fragile]
    \frametitle{Working with times}
    \verbatiminput{../R/module1/times.Rout}
\end{frame}


\begin{frame}
    \frametitle{Useful functions to look up for future advancement}
    We've covered a lot of ground in this module,
    but those interested in more advanced programming in R
    will greatly benefit from researching these functions:\\
    
    \begin{itemize}
      \item \texttt{sum}, \texttt{prod}, and \texttt{ifelse}
      \item \texttt{min}, \texttt{max}, \texttt{pmin}, and \texttt{pmax}
      \item \texttt{mean}, \texttt{var}, and \texttt{cor}
      \item \texttt{nchar}, \texttt{length}, and \texttt{dim}
      \item \texttt{with} and \texttt{within}
      \item \texttt{lapply}, \texttt{sapply}, and other \texttt{*apply}
      \item \texttt{gsub}, \texttt{grep}, \texttt{regexpr}, and other similar ones 
      \item \texttt{Map} and \texttt{Reduce}
      \item \texttt{assign} and \texttt{get}
      \item \texttt{debug} and \texttt{undebug}
    \end{itemize}
\end{frame}


\begin{frame}
    \frametitle{Exercises}
    Take 10 minutes to work on the in-class exercises for module 1.
    They can be found \href{https://github.com/rnitulescu/RcourseOncology2020/blob/master/exercises1.R}{here}.
\end{frame}


%%%%
%% MODULE 2
%%%%

\section{Module 2: Data analysis in R}



%%%%
%% MODULE 3
%%%%

\section{Module 3: Research design in R}




%% END DOCUMENT
\end{document}

